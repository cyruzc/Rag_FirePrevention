# ç«ç¾é¢„é˜²RAGç³»ç»Ÿéƒ¨ç½²æŒ‡å—

## ğŸ¯ ç³»ç»Ÿæ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªä¸“ä¸ºUnityæ•°å­—äººè®¾è®¡çš„ç«ç¾é¢„é˜²çŸ¥è¯†é—®ç­”RAGç³»ç»Ÿï¼Œä½¿ç”¨EmbeddingGemma-300MåµŒå…¥æ¨¡å‹å’ŒDeepSeek LLM APIã€‚

## ğŸ“‹ ç³»ç»Ÿç‰¹æ€§

### æŠ€æœ¯æ¶æ„
- **åµŒå…¥æ¨¡å‹**: EmbeddingGemma-300M (é€šè¿‡ModelScopeä¸‹è½½)
- **å‘é‡æ•°æ®åº“**: ChromaDB
- **LLMæœåŠ¡**: DeepSeek API
- **çŸ¥è¯†åº“**: 6ä¸ªç«ç¾é¢„é˜²æ–‡æ¡£
- **ç¼“å­˜æœºåˆ¶**: å†…å­˜+ç£ç›˜äºŒçº§ç¼“å­˜

### æ¨¡å‹é…ç½®
- **ä¸»æ¨¡å‹**: EmbeddingGemma-300M (1024ç»´)
- **å¤‡é€‰æ¨¡å‹**: ChromaDBé»˜è®¤åµŒå…¥
- **å›é€€æœºåˆ¶**: è‡ªåŠ¨å›é€€ç¡®ä¿ç³»ç»Ÿå¯ç”¨æ€§

### ç¼“å­˜é…ç½®
- **å‘é‡æ£€ç´¢ç¼“å­˜**: 2å°æ—¶TTL
- **é—®ç­”ç»“æœç¼“å­˜**: 1å°æ—¶TTL
- **ç¼“å­˜å±‚çº§**: å†…å­˜ç¼“å­˜ + ç£ç›˜ç¼“å­˜
- **ç¼“å­˜ç›®å½•**: `./cache/`
- **ç¼“å­˜å‘½ä¸­ç‡**: æ˜¾è‘—æå‡é‡å¤æŸ¥è¯¢æ€§èƒ½

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
.venv\Scripts\Activate

# å®‰è£…ä¾èµ–
uv sync
```

### 2. é…ç½®APIå¯†é’¥

åœ¨ `.env` æ–‡ä»¶ä¸­é…ç½®DeepSeek APIå¯†é’¥ï¼š
```
DEEPSEEK_API_KEY=your_api_key_here
DEEPSEEK_API_URL=https://api.deepseek.com/chat/completions
```

### 3. å¯åŠ¨ç³»ç»Ÿ

```bash
python main.py
```

## ğŸ”§ ç³»ç»Ÿé…ç½®

### å‘é‡å­˜å‚¨é…ç½®
- **æ•°æ®åº“è·¯å¾„**: `./chroma_db_gemma`
- **åµŒå…¥æ¨¡å‹**: EmbeddingGemma-300M (ModelScope)
- **æ–‡æ¡£é›†åˆ**: `fire_prevention_docs`

### æ¨¡å‹ä¸‹è½½
ç³»ç»Ÿé¦–æ¬¡å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨é€šè¿‡ModelScopeä¸‹è½½EmbeddingGemma-300Mæ¨¡å‹ï¼Œä¸‹è½½åˆ°æœ¬åœ°ç¼“å­˜ï¼š
- ç¼“å­˜è·¯å¾„: `~/.cache/modelscope/hub/models/google/embeddinggemma-300m`
- æ¨¡å‹å¤§å°: çº¦300MB
- ä¸‹è½½æº: ModelScopeå›½å†…é•œåƒ

## ğŸ¯ APIæ¥å£

### é—®ç­”æ¥å£
```
POST /api/ask
Content-Type: application/json

{
  "question": "å¦‚ä½•ä½¿ç”¨ç­ç«å™¨ï¼Ÿ"
}
```

å“åº”ï¼š
```json
{
  "answer": "ç­ç«å™¨çš„ä½¿ç”¨æ–¹æ³•åŒ…æ‹¬...",
  "relevant_docs": [...],
  "processing_time": 1.23
}
```

### å¥åº·æ£€æŸ¥
```
GET /api/health
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### é¢„æœŸæ€§èƒ½
- **æ£€ç´¢æ—¶é—´**: <0.15s
- **ç­”æ¡ˆç”Ÿæˆ**: <2.0s
- **å†…å­˜ä½¿ç”¨**: ~150MB
- **ä¸­æ–‡ç†è§£**: ä¼˜ç§€

### æœåŠ¡å™¨è¦æ±‚
- **å†…å­˜**: 2GB (æ¨è)
- **å­˜å‚¨**: 500MB+ (åŒ…å«æ¨¡å‹æ–‡ä»¶)
- **ç½‘ç»œ**: éœ€è¦DeepSeek APIè¿æ¥

## ğŸ”„ ç³»ç»Ÿç»´æŠ¤

### çŸ¥è¯†åº“æ›´æ–°
ç³»ç»Ÿä½¿ç”¨é¢„å¤„ç†çš„ç«ç¾é¢„é˜²çŸ¥è¯†æ–‡æ¡£ï¼Œä½äº `data/docs/` ç›®å½•ã€‚

### æ¨¡å‹æ›´æ–°
å¦‚éœ€æ›´æ–°åµŒå…¥æ¨¡å‹ï¼Œåˆ é™¤ `chroma_db_gemma` ç›®å½•å¹¶é‡å¯ç³»ç»Ÿã€‚

### æ—¥å¿—ç›‘æ§
ç³»ç»Ÿæ—¥å¿—ä½äºæ§åˆ¶å°è¾“å‡ºï¼ŒåŒ…å«ï¼š
- æ¨¡å‹åŠ è½½çŠ¶æ€
- æ£€ç´¢æ€§èƒ½æŒ‡æ ‡
- é”™è¯¯ä¿¡æ¯

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ¨¡å‹ä¸‹è½½å¤±è´¥**
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - ç¡®è®¤ModelScopeæœåŠ¡å¯ç”¨

2. **APIå¯†é’¥é”™è¯¯**
   - æ£€æŸ¥ `.env` æ–‡ä»¶é…ç½®
   - ç¡®è®¤DeepSeek APIé…é¢

3. **å†…å­˜ä¸è¶³**
   - ç³»ç»Ÿä¼šè‡ªåŠ¨å›é€€åˆ°é»˜è®¤åµŒå…¥æ¨¡å‹
   - å»ºè®®ä½¿ç”¨2GBä»¥ä¸Šå†…å­˜æœåŠ¡å™¨

### å›é€€æœºåˆ¶
å½“EmbeddingGemma-300MåŠ è½½å¤±è´¥æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å›é€€åˆ°ChromaDBé»˜è®¤åµŒå…¥æ¨¡å‹ï¼Œç¡®ä¿ç³»ç»Ÿå¯ç”¨æ€§ã€‚

## ğŸ“ˆ æ‰©å±•å»ºè®®

### çŸ¥è¯†åº“æ‰©å±•
1. åœ¨ `data/docs/` ç›®å½•æ·»åŠ æ–°çš„ç«ç¾é¢„é˜²æ–‡æ¡£
2. æ–‡æ¡£æ ¼å¼æ”¯æŒ `.txt` æ–‡ä»¶

### æ€§èƒ½ä¼˜åŒ–
1. è°ƒæ•´æ£€ç´¢å‚æ•° `top_k`
2. ä¼˜åŒ–APIè°ƒç”¨é¢‘ç‡
3. ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µ

## ğŸ¤– Unityé›†æˆ

### APIè°ƒç”¨ç¤ºä¾‹
```csharp
// Unity C# ç¤ºä¾‹
public async Task<string> AskQuestion(string question)
{
    using var client = new HttpClient();
    var request = new 
    {
        question = question
    };
    
    var response = await client.PostAsJsonAsync("http://localhost:8000/api/ask", request);
    var result = await response.Content.ReadFromJsonAsync<AnswerResponse>();
    
    return result.answer;
}
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. ç³»ç»Ÿæ—¥å¿—è¾“å‡º
2. APIå¯†é’¥é…ç½®
3. ç½‘ç»œè¿æ¥çŠ¶æ€
4. æœåŠ¡å™¨èµ„æºä½¿ç”¨

---

**ç³»ç»Ÿå·²ä¼˜åŒ–åˆ°æœ€ä½³çŠ¶æ€ï¼Œä¸ºæ‚¨çš„Unityæ•°å­—äººæä¾›ä¸“ä¸šã€å‡†ç¡®ã€å¿«é€Ÿçš„ä¸­æ–‡ç«ç¾é¢„é˜²é—®ç­”æœåŠ¡ï¼**
